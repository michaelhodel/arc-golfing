def p(g):R,W,*A=range,15;F,*P=sum(g,A),A;[A==(A:=A+[z for z in R(x,150,W)if(W>x)&F[z]])>[]<[P:=[c+[(a,A)]for a in R(45)for c in(F[a]<1)*P],A:=[]]for x in R(16)];return max([*zip(*[((any(z-a+min(h)in h*(a%W-z%W<6)for a,h in c)|F[z]%5)%3 for z in R(150))]*W)]for c in P)